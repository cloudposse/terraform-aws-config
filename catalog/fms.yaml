fms-shield-resource-policy-check:
  identifier: FMS_SHIELD_RESOURCE_POLICY_CHECK
  description: >-
    Checks whether an Application Load Balancer, Amazon CloudFront distributions, Elastic Load Balancer or Elastic IP
    has AWS Shield protection. This rule also checks if they have web ACL associated for Application Load Balancer and
    Amazon CloudFront distributions.
  inputParameters:
    # The following parameters are optional:
    #
    # webACLId:               The WebACLId of the web ACL.
    # resourceTags:           The resource tags associated with the rule. For example, { "tagKey1" : ["tagValue1"],
    #                         "tagKey2" : ["tagValue2", "tagValue3"] }").
    # excludeResourceTags:    If true, exclude the resources that match the resourceTags. If false, include all the
    #                         resources that match the resourceTags.
    # fmsManagedToken:        A token generated by AWS Firewall Manager when creating the rule in your account. AWS
    #                         Config ignores this parameter when you create this rule.
    # fmsRemediationEnabled:  If true, AWS Firewall Manager will update NON_COMPLIANT resources according to FMS policy.
    #                         AWS Config ignores this parameter when you create this rule.
    webACLId: ""
    resourceTags: ""
    excludeResourceTags: ""
    fmsManagedToken: ""
    fmsRemediationEnabled: ""
  enabled: true
  tags:
    catalog/fms: true

fms-webacl-resource-policy-check:
  identifier: FMS_WEBACL_RESOURCE_POLICY_CHECK
  description: >-
    Checks whether the web ACL is associated with an Application Load Balancer, API Gateway stage, or Amazon CloudFront
    distributions. When AWS Firewall Manager creates this rule, the FMS policy owner specifies the WebACLId in the FMS
    policy and can optionally enable remediation.
  inputParameters: webACLId
  enabled: true
  tags:
    catalog/fms: true

fms-webacl-rulegroup-association-check:
  identifier: FMS_WEBACL_RULEGROUP_ASSOCIATION_CHECK
  description: >-
    Checks that the rule groups associate with the web ACL at the correct priority. The correct priority is decided by
    the rank of the rule groups in the ruleGroups parameter. When AWS Firewall Manager creates this rule, it assigns the
    highest priority 0 followed by 1, 2, and so on. The FMS policy owner specifies the ruleGroups rank in the FMS policy
    and can optionally enable remediation.
  inputParameters: ruleGroups
  enabled: true
  tags:
    catalog/fms: true
